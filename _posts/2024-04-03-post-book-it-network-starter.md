---
title: "[Book] IT 엔지니어를 위한 네트워크 입문"
excerpt: ""

categories:
  - Book
tags:
  - Network
last_modified_at: 2024-04-04T00:00:00
---


# 1.4. OSI 7 계층별 이해하기

- OSI 7 Layer
    - 1계층-물리 : 물리적인 신호 전달이 목표이며, 주소 개념이 없기에 연결된 모든 포트로 전달한다. 허브, 리피터 등이 해당한다.
    - 2계층-데이터링크 : 전기 신호를 모아 데이터 형태로 처리하며, 물리적인 MAC 주소를 통해 내 데이터만 받아들일 수 있고 근래에는 Flow Control(상대가 받을 수 있는지 체크) 정도만 수행한다. 해당하는 장비로는 네트워크 인터페이스 카드(NIC), 스위치 등이 있다.
    - 3계층-네트워크 : 논리적인 IP주소를 통해 자신의 네트워크와 원격지 네트워크를 구분할 수 있고 원격지 경로를 지정 할 수 있다. 라우터가 해당한다.
    - 4계층-트랜스포트 : 하위 계층들의 데이터가 잘 보내졌는지 확인(유실시 재요청, 순서바뀜 시 정렬)하고 포트 번호를 통해 상위 애플리케이션을 구분한다. 로드밸런서나 방화벽 등을 통해 패킷을 통과, 차단 관리한다.
    - 5계층-세션 : TCP/IP 세션을 만들고 없애는 책임을 지며, 에러 복구와 재전송도 수행한다.
    - 6계층-프레젠테이션 : 표현 방식이 다른 애플리케이션이나 시스템 간의 통신을 위해 통일된 구문 형식으로 변환 시킨다. MIME 인코딩, 암호화, 압축, 코드 변환과 같은 것들이 있다.
    - 7계층-애플리케이션 : UI나 사용자 입/출력을 정의 하는 네트워크 애플리케이션의 역할이다. 프로토콜로는 FTP, SMTP, HTTP, TELNET 이 있다.
    

# 3.3. IP 주소

- 클래스풀 주소 체계의 단점(비효율적인 IP사용)을 보완하기 위해 첫번째 대책으로 클래스리스, CIDR(classiess Inter-Domain Routing)체계가 나오고, 두번째 대책으로 NAT와 사설 IP, 그리고 세번째 대책으로 IPv6가 나왔다.
- 모든 단말에 공인 IP를 할당할 수 없기에 내부 내트워크는 사설 IP를 할당해서 사용하고, NAT(Network Address Translation)을 통해 공인 IP로 변환해서 인터넷에서 통신 가능하다. (e.g. 공유기) 단, 이렇게 내부 네트워크에서도 사설 IP 대역을 사용해야 한다. 만약 공인 IP로 사용되는 IP를 내부 네트워크에 할당하게 되면, 실제 그 공인 IP와 연결을 수립하려고 할때 내부에 이미 그 IP가 존재하므로 연결할 수 없다.

# 6. 로드밸런서/방화벽:4계층 장비(세션 장비)

- 4계층에서는 2, 3계층에서 고려하지 않았던 통신의 방향성이나 순서와 같은 것들에 대한 관리가 필요하며, 이런 정보를 세션 테이블에 저장하고 관리한다.

# 7. 통신을 도와주는 네트워크 주요 기술

- DHCP(Dynamic Host Configuration Protocol) : 사용자가 IP 설정을 하지 않아도 자동으로 IP를 할당해 준다.
- GSLB(Global Server Load Balancing) : 사용자가 가장 가까운 지역의 데이터 센터에 접속해 신속한 서비스를 받게 해 준다.
- NAT : “NAT는 IP 주소를 다른 IP 주소로 변환해 라우팅을 원활히 해주는 기술”. 하나의 IP를 사용해 여러 단말 장비를 포함하는 네트워크를 손쉽게 구축하게 도와준다.
- 부족한 IPv4 주소 보존전략 중 단기 전략은 서브네팅, 중기 전략은 NAT와 사설 IP체계, 장기 전략은 IPv6 전환이다.
- 호스트는 DNS 서버에 재귀적 쿼리를 하고, DNS 서버는 root, first, second, third level 에 반복적으로 질의한다.
- DNS 주요 레코드
    - A : 도메인 주소를 IP 주소로 매핑
    - CNAME : 도메인 주소에 대한 별칭
    - SOA : 본 영역 데이터에 대한 권한
    - NS : 본 영역에 대한 네임 서버
- DNS 위임은 일부 도메인 관리 권한을 위임한 곳에서 세부 레코드를 관리하는 것으로 CDN이나 GSLB가 대표적인 예이다.
- GSLB
    - DNS에서는 동일한 레코드로 동시에 다른 IP를 매핑할 수 있지만 , 헬스체크를 할 수 없는데 헬스체크를 통해서 정상적인 레코드만 응답한다.
    - client가 LDNS에게 도메인 질의 → LDNS가 root DNS에 질의 → root DNS가 위임한 GSLB 주소를 받아 LDNS가 GSLB에 질의
    - 도메인 구입시 도메인을 관리하는 NS(네임서버)를 GSLB로 지정해서 모두 관리하게 하는 방식과 도메인 내의 특정 레코드만 GSLB에 위임하는 경우가 있다.
    - 라운드 로빈, 최소 접속, 해싱 방식 등 분산 방식을 제공하며, 응답/지연 시간과   지리정보를 통한 헬스체크 분산을 지원한다.
- DHCP(Dynamic Host Configuration Protocol)
    - IP 주소, 서브넷 마스크, 게이트웨이, DNS등을 자동으로 할동받는 프로토콜이다.
    - 자동 할당의 편리함, 미사용시 회수해서 효율적인 사용, 중복할당 방지 등 장점이 있다.
    - 클라이언트와 DHCP 서버가 Discover, Offer, Request 등의 메시지를 주고받아 할당받는다.

# 8. 서버 네트워크 기본

- ping(Packet InterNet Groper)
    - IP 네트워크를 통해 특정 목적지까지 네트워크가 잘 동작하고 있는지 확인하는 명령어다.
    - ICMP(Internet Control Message Protocol)을 사용하기에 제어 메시지를 통해 여러가지 네트워크 상태 파악이 가능하다.
    - ping을 체크하는 출발지 IP를 지정 할 수 있고, 횟수, 패킷크기, 홉의 경로 기록 등이 가능하다.
- tcping(윈도우)
    - 목적지의 실제 서비스 포트로 정상적인 통신이 가능한지 확인하는 명령어다.(telnet과 유사)
    - 별도로 다운받아야 한다.
- traceroute(리눅스)/tracert(윈도우)
    - 라우팅 경로를 확인/문제가 발생한 구간/구간의 응답속도 등을 알아낼 수 있는 명령어다.
- tcptraceroute
    - ping/tcping과의 관계처럼 경로 + 서비스 포트 확인하는 명령어다.
- netstat(network statistics)
    - 서버의 다양한 네트워크 상태를 확인할 수 있는 명령어인데 특히 서비스 포트 상태 확인에 사용된다.
- ss(socket statistics)
    - 소켓 정보 확인하는 명령어이다.
- nslookup(name server lookup)
    - DNS에 다양한 도메인 관련 내용을 질의해 결괏값을 전송받을 수 있는 명령어이다.
- telnet(tele network)
    - 원격지 호스트에 터미널을 연결하기 위한 오래된 프로토콜이며, 특정 서비스가 열려있는지 확인하는 용도로 주로 사용한다.
    - 최근에는 암호화된 SSH 사용이 권고된다.
    

# 12. 로드 밸런서

- 헬스체크 방식
    - ICMP(ping)을 사용하는 단순한 방법으로 잘 사용하지 않음.
    - TCP 서비스 포트로 SYN/ACK를 주고 받는 3 way hand shaking으로 확인.
    - TCP 서비스 포트 확인하지만 3 way 대비 비용이 절감되는 Half Open 을 사용.
    - 3 way 후 HTTP 상태 코드(200)을 받아 확인.
    - 콘텐츠(문자열)을 확인하여 지정한 내용이 있는지 확인.
- 부하분산 알고리즘
    - 라운드 로빈 : 백엔드 장비에 부하를 순차적으로 분산.
    - 최소 접속  : 활성화된 세션수가 적은 장비로 우선 분산.
    - 가중치 기반 라운드 로빈 : 라운드 로빈을 기반으로 가중치가 높은 장비에 더 많이 분산. 처리용량이 다른 서버로 구성될 때 고려.
    - 가중치 기반 최소 접속 방식 : 최소 접속 방식을 기반으로 가중치가 높은 장비에 더 많이 분산. 처리 용량이 다른 서버로 구성될 때 고려.
    - 해시 : 해시 알고리즘을 이용해 분산.