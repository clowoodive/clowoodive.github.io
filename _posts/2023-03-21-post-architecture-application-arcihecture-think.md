---
title: "[Architecture] 애플리케이션 아키텍처에 관한 고민"
excerpt: ""

categories:
  - Architecture
tags:
  - Application Architecture
  - DTO
  - VO
  - Domain Model
last_modified_at: 2023-03-21T00:00:00
---


프레젠테이션 / 서비스 / 데이터 액세스 계층으로 구분되는 3계층 아키텍처에서 어떤 부분이 부족해서 테스트 코드 작성하기가 어려운지 고민한 적이 있었다.
업무 프로젝트의 구조는 변경하지 못하더라도 예제나 개인 프로젝트에는 효율적인 애플리케이션 아키텍처를 적용하고 싶었는데 정답이 없다보니 검색으로도 답을 얻기가 어려웠다. 
트렌디하다 라고 하기는 조금 그렇고 더 개발에 최적화 된 아키텍처를 파악하고 싶었지만 Entity, Domain, DTO, VO 등등 개념이 기술에 따라 해석이 난해하고 심지어 Mybatis를 사용하니 더 결정하기가 어려웠다. 오래된 토비의 스프링에 나온 개념이지만 간단히 정리해 본다.

### 데이터 중심 아키텍처

- DB/SQL 중심 로직 구현 방식
    
    SQL에 로직이 있거나 한가지 요청의 처리에 종속적인 로직과 DB 스키마를 갖는 방식. 
    
    재사용이 어렵고 변경사항이 여러 계층에 영향을 주면서 확장성이 떨어지고 테스트가 어려움.
    
- 거대한 서비스 계층 방식
    
    DB 프로시저와 복잡한 SQL사용을 피하면서 서비스 계층에서 주요 로직을 모두 처리하는 방식.테스트는 좀더 용이하지만 특정 업무 트랜잭션에 종속되는 데이터 구조는 여전하며 결합도가 높아 코드를 발전시키기 어려움.
    

### 오브젝트 중심 아키텍처

- 빈약한 도메인 오브젝트 방식
    - 도메인 모델을 반영하는, 어느 계층에서도 사용될 수 있는 일관된 형식의 오브젝트 구조를 만들어서 각 계층 사이에서 정보를 전송하는데 사용.
    - RDB에서 처럼 외래키를 사용하지 않고 레퍼런스 변수로 참조하여 관계를 나타냄.
    - DAO는 SQL을 한개 썼든 두개 썼든 상관없이 도메인 모델 오브젝트에 담아주기만 하면 되고, 다른 계층은 이용만 하면 됨.
    - getter, setter 정도만 있음.
- 풍성한 도메인 오브젝트 방식
    - 빈약한 도메인 오브젝트 방식에서 도메인 오브젝트에 종속성을 가지는 로직은 그 도메인 오브젝트에 정의해서 응집도를 높이는 방식.
    

책을 읽고 나서는 `풍성한 도메인 오브젝트 방식`이 현재 해왔던 `거대한 서비스 계층 방식`과 비교해서 장점이 확실히 있다고 생각되었지만, JPA 기반에서 Entity와 DTO를 구분해서 사용하는 것처럼 분리 했을때 유지보수 관점에서 유리한 면도 있다는 생각이 든다.
현재 MyBatis 환경이기에 각각의 방식에서 장점이라고 생각되는 부분들만 적용해서 아래와 같이 구현 해봐야겠다.

### 프레젠테이션 -<VO>- 서비스 -<DTO>- 데이터 액세스

- VO - 프레젠테이션과 서비스 계층 사이에 주고 받는 용도로 사용.
- DTO - 서비스 계층과 데이터 액세스 계층간에 변경이 가능하면서 종속적인 로직을 포함하는 변형된 오브젝트.